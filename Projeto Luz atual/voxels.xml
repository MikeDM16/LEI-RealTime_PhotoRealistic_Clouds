<?xml version="1.0" ?>
<project name="Voxels" width="1024" height="512">
	<assets>
		<constants>
			<constant name="GridSize" value = "128" />
		</constants>
		<attributes>
			<attribute name="GridSize" type="PASS" data="INT" value="GridSize" />
			<attribute name="GridLevels" type="PASS" data="INT" value=7 />
			<attribute name="GridCurrentLevel" type="PASS" data="INT" value=0 />
			<attribute name="aabbMin" type="PASS" data="VEC3" x=-5 y= 3 z=-5/>
			<attribute name="aabbMax" type="PASS" data="VEC3" x=5 y= 6 z=5/>

			<!-- terrain parameters -->
			<attribute type="COLOR" name="scale" data="FLOAT" value=15/>
			<attribute type="COLOR" name="layer_Height" data="FLOAT" value=3.0/>
			
			<attribute type="COLOR" name="threshold_erosion" data="FLOAT" value=0.15/>
			<attribute type="COLOR" name="erosion_amount" data="FLOAT" value=50/>

			<attribute type="COLOR" name="sigmaScattering" data="FLOAT" value=0.15/>
			<attribute type="COLOR" name="sigmaExtintion" data="FLOAT" value=0.15/>
			<attribute type="COLOR" name="sigmaAbsorption" data="FLOAT" value=0.15/>
			<attribute type="COLOR" name="g0_phase_function" data="FLOAT" value=0.8/>
			<attribute type="COLOR" name="g1_phase_function" data="FLOAT" value=-0.5/>
			<attribute type="COLOR" name="phase_mix" data="FLOAT" value=0.5/>

			<attribute type="COLOR" name="volume_steps" data="INT" value=128/>
		</attributes>
		<scenes>
			<!--scene name="MainScene" param="UNITIZE">
				<file name="../../testModels/cube.obj"/>
			</scene>
			<scene name="VoxelTest" param="UNITIZE">
				<file name="../../testModels/voxeltest.obj"/>
			</scene>
			<scene name="Bench" param="UNITIZE">
				<file name="../../testModels/ntg-bench/bench.obj"/>
			</scene>
			<scene name="Sponza" param="UNITIZE">
				<file name="../../testModels/sponza/crytek-sponza/sponza.nbo"/>
			</scene>
			<scene name="Cube" >
				<file name="../../testModels/cube.obj"/>
			</scene-->
			<scene name="Dummy" >
				<buffers name="positions" primitive="POINTS" material="showRays">
					<position name="dummy" fromLibrary="Voxels" />
				</buffers>
			</scene>

			<scene name="terrain" type="Scene">
				<geometry name = "terra" type = "GRID" material="terrain"
							DIVISIONS=20 LENGTH=100 >
							<SCALE x=0.10 y=0.20 z=0.10/>
							<TRANSLATE x =0 y = -3 z = 0 />
				</geometry>
			</scene>
		</scenes>

		<viewports>
			<viewport name="MainViewport">
				<CLEAR_COLOR r="0.2" g="0.5" b="1.0" />
			</viewport>

			<viewport name="Grid">
				<CLEAR_COLOR r="0.0" g="1.0" b="0.0" />
				<SIZE x="GridSize" y="GridSize" />
			</viewport>
		</viewports>

		<cameras>
			<camera name="MainCamera">
				<viewport name="MainViewport" />
				<projection TYPE="PERSPECTIVE" FOV=60 NEAR=0.01 FAR=2000.0 />
				<POSITION x=-7 y= 7 z= 10  />
				<VIEW x=0.50 y=-0.32 z=-0.80 />
				<UP x=0 y=1 z=0 />
			</camera>
		</cameras>

		<lights>
			<light name="Sun" >
				<DIRECTION x=0 y=-1 z=0 />
				<POSITION x=0 y=100 z=0 />
				<COLOR r="1" g="1" b="1" />
				<AMBIENT r="0.5" g="0.0" b="0.0" />
			</light>
		</lights>

		<materialLibs>
			<materialLib filename="voxels.mlib"/>
			<materialLib filename="TextureModel.mlib"/>
		</materialLibs>
	</assets>


	<pipelines>
		<pipeline name="voxels" default="true">
			<!--pass class="default" name="pass3" >
				<scenes>
					<scene name="terrain" />
				</scenes>
				<camera name="MainCamera" />
				<lights>
					<light name="Sun" />
				</lights>
				<materialMaps>
					<map fromMaterial="*" toLibrary="Texture" toMaterial="terrain" />
				</materialMaps>
			</pass-->

			<pass class="default" name="showVoxels">
				<scenes>
					<scene name="Dummy" />
				</scenes>
				<camera name="MainCamera" />
				<lights>
					<light name="Sun" />
				</lights>
				<viewport name="MainViewport" />
				<materialMaps>
					<map fromMaterial="*"
						 toLibrary="Voxels" toMaterial="showVoxels" />
				</materialMaps>
			</pass>

		</pipeline>
	</pipelines>

	<interface>
		<!--window label="Phase Function" >
			<pipelineList label="Parametros" />

			<var label="Mix Phase Function" type="COLOR" context="Voxels::showVoxels"
					component="phase_mix" def="min=0.0 max=1 step=0.05" />
			<var label="G0 Phase Function" type="COLOR" context="Voxels::showVoxels"
					component="g0_phase_function" def="min=-0.99 max=0.99 step=0.05" />
			<var label="GI Phase Function" type="COLOR" context="Voxels::showVoxels"
					component="g1_phase_function" def="min=-0.99 max=0.99 step=0.05" />
		</window>

		<window label="shape Parameters">
			<pipelineList label="Parametros" />

			<var label="Threshold Erosion" type="COLOR" context="Voxels::showVoxels"
					component="threshold_erosion" def="min=0.0 max=1.0 step=0.01" />
			<var label="Erosion amount" type="COLOR" context="Voxels::showVoxels"
					component="erosion_amount" def="min=0.0 max=250 step=1" />
		</window-->
		
		<window label="settings" >
			<pipelineList label="Parametros" />
			<var label="Cloud layer_Height" type="COLOR" context="Voxels::showVoxels"
					component="layer_Height" def="min=1 max=10 step=0.5" />
			<var label="scale" type="COLOR" context="Texture::terrain"
					component="scale" def="min=0 max=100 step=5" />
			
			<var label="Threshold Erosion" type="COLOR" context="Voxels::showVoxels"
					component="threshold_erosion" def="min=0.0 max=1.0 step=0.01" />
			<var label="Erosion amount" type="COLOR" context="Voxels::showVoxels"
					component="erosion_amount" def="min=0.0 max=250 step=1" />
			
			<var label="G0 Phase Function" type="COLOR" context="Voxels::showVoxels"
					component="g0_phase_function" def="min=-0.99 max=0.99 step=0.05" />
			<var label="GI Phase Function" type="COLOR" context="Voxels::showVoxels"
					component="g1_phase_function" def="min=-0.99 max=0.99 step=0.05" />
			<var label="Mix Phase Function" type="COLOR" context="Voxels::showVoxels"
					component="phase_mix" def="min=0.0 max=1 step=0.05" />
			
			<var label="Sigma Absorption" type="COLOR" context="Voxels::showVoxels"
					component="sigmaAbsorption" def="min=0.0 max=20 step=0.05" />
			<var label="Sigma Scattering" type="COLOR" context="Voxels::showVoxels"
					component="sigmaScattering" def="min=0.0 max=20 step=0.05" />
			
			<var label="RayMarch steps" type="COLOR" context="Voxels::showVoxels"
					component="volume_steps" def="min=0 max=512 step=32" />
		</window>
	</interface>
</project>
